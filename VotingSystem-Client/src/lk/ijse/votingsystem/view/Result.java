/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package lk.ijse.votingsystem.view;

import java.awt.Color;
import java.util.HashMap;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.table.DefaultTableModel;
import lk.ijse.votingsystem.controller.VoteController;
import lk.ijse.votingsystem.dto.ElectionDTO;
import lk.ijse.votingsystem.dto.ResulltDTO;
import lk.ijse.votingsystem.dto.VoteDTO;
import net.sf.jasperreports.engine.JRException;
import net.sf.jasperreports.engine.JasperFillManager;
import net.sf.jasperreports.engine.JasperPrint;
import net.sf.jasperreports.engine.JasperReport;
import net.sf.jasperreports.engine.data.JRTableModelDataSource;
import net.sf.jasperreports.engine.util.JRLoader;
import net.sf.jasperreports.swing.JRViewer;

/**
 *
 * @author HP
 */
public class Result extends javax.swing.JInternalFrame {

    /**
     * Creates new form Result
     */
    private String eId;
    private JasperReport jasperReport;

    public Result() {
        initComponents();
        loadJasper();
        loadPresident();
        loadSecretary();
        loadMembers();

    }

    private void loadJasper() {
        try {
            jasperReport = (JasperReport) JRLoader.loadObject(Result.class.getResourceAsStream("/lk/ijse/votingsystem/jasper/Blank_A4.jasper"));
        } catch (JRException ex) {
            Logger.getLogger(Result.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jXPanel1 = new org.jdesktop.swingx.JXPanel();
        jXLabel1 = new org.jdesktop.swingx.JXLabel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblPresident = new org.jdesktop.swingx.JXTable();
        jXLabel2 = new org.jdesktop.swingx.JXLabel();
        jScrollPane2 = new javax.swing.JScrollPane();
        tblMember = new org.jdesktop.swingx.JXTable();
        jScrollPane3 = new javax.swing.JScrollPane();
        tblSecreatary = new org.jdesktop.swingx.JXTable();
        jXLabel3 = new org.jdesktop.swingx.JXLabel();
        jXButton1 = new org.jdesktop.swingx.JXButton();
        jXButton2 = new org.jdesktop.swingx.JXButton();
        jXButton3 = new org.jdesktop.swingx.JXButton();
        jXLabel5 = new org.jdesktop.swingx.JXLabel();
        jXLabel6 = new org.jdesktop.swingx.JXLabel();
        jXLabel4 = new org.jdesktop.swingx.JXLabel();
        jXLabel7 = new org.jdesktop.swingx.JXLabel();
        jXLabel8 = new org.jdesktop.swingx.JXLabel();
        jXLabel9 = new org.jdesktop.swingx.JXLabel();

        jXPanel1.setBackground(new java.awt.Color(255, 255, 255));
        jXPanel1.setLayout(new org.netbeans.lib.awtextra.AbsoluteLayout());

        jXLabel1.setText("Election results for President Candidates");
        jXLabel1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jXPanel1.add(jXLabel1, new org.netbeans.lib.awtextra.AbsoluteConstraints(90, 30, -1, 31));

        tblPresident.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Candidate No.", "Name", "Total Votes"
            }
        ));
        jScrollPane1.setViewportView(tblPresident);

        jXPanel1.add(jScrollPane1, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 60, 440, 130));

        jXLabel2.setText("Election results for Secretary Candidates");
        jXLabel2.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jXPanel1.add(jXLabel2, new org.netbeans.lib.awtextra.AbsoluteConstraints(550, 30, -1, 31));

        tblMember.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Candidate No.", "Name", "Total Votes"
            }
        ));
        jScrollPane2.setViewportView(tblMember);

        jXPanel1.add(jScrollPane2, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 260, 393, 136));

        tblSecreatary.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {

            },
            new String [] {
                "Candidate No.", "Name", "Total Votes"
            }
        ));
        jScrollPane3.setViewportView(tblSecreatary);

        jXPanel1.add(jScrollPane3, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 60, 393, 113));

        jXLabel3.setText("Election results for Union Members");
        jXLabel3.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
        jXPanel1.add(jXLabel3, new org.netbeans.lib.awtextra.AbsoluteConstraints(50, 230, -1, 31));

        jXButton1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 2));
        jXButton1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/lk/ijse/votingsystem/image/print.png"))); // NOI18N
        jXButton1.setText("Print");
        jXButton1.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jXButton1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                jXButton1ActionPerformed(evt);
            }
        });
        jXPanel1.add(jXButton1, new org.netbeans.lib.awtextra.AbsoluteConstraints(350, 200, 146, 40));

        jXButton2.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 2));
        jXButton2.setIcon(new javax.swing.ImageIcon(getClass().getResource("/lk/ijse/votingsystem/image/print.png"))); // NOI18N
        jXButton2.setText("Print");
        jXButton2.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jXPanel1.add(jXButton2, new org.netbeans.lib.awtextra.AbsoluteConstraints(810, 180, 146, 40));

        jXButton3.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 2));
        jXButton3.setIcon(new javax.swing.ImageIcon(getClass().getResource("/lk/ijse/votingsystem/image/print.png"))); // NOI18N
        jXButton3.setText("Print");
        jXButton3.setFont(new java.awt.Font("Tahoma", 1, 18)); // NOI18N
        jXPanel1.add(jXButton3, new org.netbeans.lib.awtextra.AbsoluteConstraints(350, 400, 146, 40));

        jXLabel5.setText("* Now, Candidate who received highest votes to Secretary -:");
        jXLabel5.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jXPanel1.add(jXLabel5, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 340, 380, 30));

        jXLabel6.setText("president");
        jXPanel1.add(jXLabel6, new org.netbeans.lib.awtextra.AbsoluteConstraints(670, 370, 310, 20));

        jXLabel4.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
        jXPanel1.add(jXLabel4, new org.netbeans.lib.awtextra.AbsoluteConstraints(520, 230, 440, 180));

        jXLabel7.setText("* Now, Candidate who received highest votes to President -:");
        jXLabel7.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        jXPanel1.add(jXLabel7, new org.netbeans.lib.awtextra.AbsoluteConstraints(540, 270, 380, 30));

        jXLabel8.setText("president");
        jXPanel1.add(jXLabel8, new org.netbeans.lib.awtextra.AbsoluteConstraints(680, 304, 310, 20));

        jXLabel9.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0), 3));
        jXPanel1.add(jXLabel9, new org.netbeans.lib.awtextra.AbsoluteConstraints(30, 20, 950, 470));

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jXPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jXPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, 517, javax.swing.GroupLayout.PREFERRED_SIZE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void jXButton1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_jXButton1ActionPerformed
        try {

            DefaultTableModel dtm = (DefaultTableModel) tblPresident.getModel();
            JasperPrint filledReport = JasperFillManager.fillReport(jasperReport, null, new JRTableModelDataSource(dtm));
            JRViewer jRViewer = new JRViewer(filledReport);
            jRViewer.setOpaque(true);
            jRViewer.setBackground(Color.WHITE);
//            pnlJasper.removeAll();
//            pnlJasper.add(jRViewer);
//            pnlJasper.setVisible(true);
            PresidentJasper p = new PresidentJasper(jRViewer);
            p.setVisible(true);
        } catch (JRException ex) {
            Logger.getLogger(Result.class.getName()).log(Level.SEVERE, null, ex);
        }
    }//GEN-LAST:event_jXButton1ActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JScrollPane jScrollPane2;
    private javax.swing.JScrollPane jScrollPane3;
    private org.jdesktop.swingx.JXButton jXButton1;
    private org.jdesktop.swingx.JXButton jXButton2;
    private org.jdesktop.swingx.JXButton jXButton3;
    private org.jdesktop.swingx.JXLabel jXLabel1;
    private org.jdesktop.swingx.JXLabel jXLabel2;
    private org.jdesktop.swingx.JXLabel jXLabel3;
    private org.jdesktop.swingx.JXLabel jXLabel4;
    private org.jdesktop.swingx.JXLabel jXLabel5;
    private org.jdesktop.swingx.JXLabel jXLabel6;
    private org.jdesktop.swingx.JXLabel jXLabel7;
    private org.jdesktop.swingx.JXLabel jXLabel8;
    private org.jdesktop.swingx.JXLabel jXLabel9;
    private org.jdesktop.swingx.JXPanel jXPanel1;
    private org.jdesktop.swingx.JXTable tblMember;
    private org.jdesktop.swingx.JXTable tblPresident;
    private org.jdesktop.swingx.JXTable tblSecreatary;
    // End of variables declaration//GEN-END:variables

    private void loadPresident() {
        try {

            //List<Object[]> presidentList=VoteResultsController.getResult();
            DefaultTableModel dtm = (DefaultTableModel) tblPresident.getModel();

            List<ResulltDTO> voteResult = VoteController.getPresidentVote();
            System.out.println("list" + voteResult);
            for (ResulltDTO resulltDTO : voteResult) {
                
                Object[] rowData = {resulltDTO.getCanNo(), resulltDTO.getCanName(), resulltDTO.getTotVote()+""};
                dtm.addRow(rowData);
            }
        } catch (Exception ex) {
            Logger.getLogger(Result.class.getName()).log(Level.SEVERE, null, ex);
        }
    }

    private void loadSecretary() {
        try {
            DefaultTableModel dtm = (DefaultTableModel) tblSecreatary.getModel();
            List<ResulltDTO> voteResult = VoteController.getSecretaryVote();
            System.out.println("list11" + voteResult);
            for (ResulltDTO resulltDTO : voteResult) {
                Object[] rowData = {resulltDTO.getCanNo(), resulltDTO.getCanName(), resulltDTO.getTotVote()};
                dtm.addRow(rowData);
            }
        } catch (Exception ex) {
            Logger.getLogger(Result.class.getName()).log(Level.SEVERE, null, ex);
        }

    }

    private void loadMembers() {
        try {
            DefaultTableModel dtm = (DefaultTableModel) tblMember.getModel();
            List<ResulltDTO> voteResult = VoteController.getMembers();

            for (ResulltDTO resulltDTO : voteResult) {
                Object[] rowData = {resulltDTO.getCanNo(), resulltDTO.getCanName(), resulltDTO.getTotVote()};
                dtm.addRow(rowData);
            }
        } catch (Exception ex) {
            Logger.getLogger(Result.class.getName()).log(Level.SEVERE, null, ex);
        }

    }
}
